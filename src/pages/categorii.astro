---
import PageHero from "@/components/ui/typography/PageHero.astro"
import BaseLayout from "@/layouts/BaseLayout.astro"
import { pb_to_proxy } from "@/lib/util"
import { getCollection } from "astro:content"

const allCategorii = (await getCollection("categorii"))
  .map((categ) => {
    const imagine_url = pb_to_proxy(categ.data.imagine!)
    return { imagine_url, ...categ }
  })
  .sort((x, y) => x.data._order - y.data._order)
---

<BaseLayout title="Categorii">
  <PageHero title="Categorii" />

  <ul class="grid gap-4 sm:grid-cols-2 sm:px-2 lg:grid-cols-3">
    {
      allCategorii.map((categ) => {
        const { nume, icon, descriere, imagine, slug } = categ.data
        return (
          <li class="bg-muted">
            <a href={`/c/${slug}`} class="group block overflow-hidden">
              <img
                src={`${categ.imagine_url}?thumb=400x400f`}
                alt=""
                class="h-[300px] w-full object-cover transition duration-500 group-hover:scale-105 sm:h-[350px]"
              />
              <div class="px-1 pt-2">
                <h3 class="text-xl group-hover:underline group-hover:decoration-pink-500 group-hover:decoration-2 group-hover:underline-offset-4">
                  {nume}
                </h3>
                {descriere && <p>{descriere}</p>}
              </div>
            </a>
          </li>
        )
      })
    }
  </ul>
</BaseLayout>
