---
import { Image } from "astro:assets"
import PageHero from "@/components/ui/typography/PageHero.astro"

import BaseLayout from "@/layouts/BaseLayout.astro"
import { pb_to_proxy } from "@/lib/util"
import { getCollection } from "astro:content"
import ImgBroken from "src/assets/image-broken.png"

const allParteneri = (await getCollection("parteneri"))
  .map((part) => {
    // console.dir(part)
    const img_logo = part.data.logo ? pb_to_proxy(part.data.logo) : ImgBroken.format
    return { img_logo, ...part }
  })
  .filter((part) => part.data.publicat === true)
  .sort((x, y) => x.data._order - y.data._order)
---

<BaseLayout>
  <PageHero title="Parteneri">
    <p class="sm:max-w-3xl">
      Asigurăm o paletă completă de produse și servicii pentru industria reciclării prin parteneriate cu cei mai
      importanți producători europeni.
    </p>
  </PageHero>

  <div class="grid gap-2 sm:grid-cols-3 sm:gap-4">
    {
      allParteneri.map((partener) => {
        const { cod, nume, descriere, logo, url } = partener.data

        return (
          <a class="group bg-muted flex min-h-40 flex-col gap-2 p-2 sm:p-4" href={`/partener/${cod}`}>
            <div class="">
              <img
                src={partener.img_logo}
                class="mx-auto transition duration-500 group-hover:scale-105"
                width="300"
                alt={nume}
              />
            </div>
            <div class="px-2">
              {/* <p class="text-lg font-semibold">{nume}</p> */}
              <p class="text-center">{descriere}</p>
              <div class="grow" />
            </div>
          </a>
        )
      })
    }
  </div>
</BaseLayout>
