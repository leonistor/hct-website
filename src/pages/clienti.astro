---
import PageHero from "@/components/ui/typography/PageHero.astro"
import BaseLayout from "@/layouts/BaseLayout.astro"
import IconLink from "phosphor-astro/ArrowSquareOut.astro"

import { pb_to_proxy } from "@/lib/util"
import { getCollection } from "astro:content"

const allClienti = (await getCollection("clienti"))
  .map((client) => {
    const logo_url = pb_to_proxy(client.data.logo!)
    return { logo_url, ...client }
  })
  // .sort((x, y) => x.data._order - y.data._order)
  .sort((cx, cy) => cx.data.nume.toLocaleUpperCase().localeCompare(cy.data.nume.toLocaleUpperCase()))

// class:list={["", "hover:underline hover:decoration-pink-500 hover:decoration-2 hover:underline-offset-4"]}
---

<BaseLayout title="Clienți">
  <PageHero title="Clienți" />

  <div class="grid w-full grid-cols-1 gap-4 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4">
    {
      allClienti.map((client) => {
        const { nume, descriere, locatie, url } = client.data
        return (
          <div class="bg-accent group rounded-lg p-4">
            <div class="flex h-full flex-col items-stretch gap-2">
              <div class="self-center text-lg font-semibold">{nume}</div>
              <div class="flex grow justify-center rounded-md bg-white p-2">
                <img
                  class="object-contain"
                  width={150}
                  height={150}
                  src={`${client.logo_url}?thumb=150x150f`}
                  alt={nume}
                />
              </div>
              <div class="">{descriere}</div>
              <div class="flex flex-row items-center justify-between">
                <div class="font-light">{locatie}</div>
                {url && (
                  <a href={url} target="_blank">
                    <IconLink class="bg-ghost text-muted-foreground size-5" />
                  </a>
                )}
              </div>
            </div>
          </div>
        )
      })
    }
  </div>
</BaseLayout>
